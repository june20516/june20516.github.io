1:HL["/_next/static/css/5624dea08047460b.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["slug","rds-dump","d"],{"children":["__PAGE__?{\"slug\":\"rds-dump\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5624dea08047460b.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/ed65a566c9c7159d.css",{"as":"style"}]
5:I{"id":"6886","chunks":["771:static/chunks/771-4a62562d40204820.js","846:static/chunks/846-5374114718c3ba3f.js","218:static/chunks/218-24e2ed3a86df3181.js","185:static/chunks/app/layout-dc709c21cec9e468.js"],"name":"","async":false}
6:I{"id":"4463","chunks":["272:static/chunks/webpack-adfd2e3e7e928ad6.js","667:static/chunks/2443530c-0538301a504b83cf.js","488:static/chunks/488-c0b34e96c35b33f7.js"],"name":"","async":false}
7:I{"id":"1010","chunks":["272:static/chunks/webpack-adfd2e3e7e928ad6.js","667:static/chunks/2443530c-0538301a504b83cf.js","488:static/chunks/488-c0b34e96c35b33f7.js"],"name":"","async":false}
2:[["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["slug","rds-dump","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L8",null],"segment":"__PAGE__?{\"slug\":\"rds-dump\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/ed65a566c9c7159d.css","precedence":"next"}]]}],null],"segment":["slug","rds-dump","d"]},"styles":[]}],"segment":"posts"},"styles":[]}],"params":{}}],null]
3:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"AWS RDS의 Data base를 dump하기 - Bran's codeverse"}],["$","meta",null,{"name":"description","content":"VPC 내부에 있는 RDS에서 데이터베이스를 덤프하고, 이를 로컬 MySQL로 복구하는 과정에서 겪은 문제들을 기록한다."}],null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,[null,["$","meta",null,{"property":"og:title","content":"AWS RDS의 Data base를 dump하기 - Bran's codeverse"}],["$","meta",null,{"property":"og:description","content":"VPC 내부에 있는 RDS에서 데이터베이스를 덤프하고, 이를 로컬 MySQL로 복구하는 과정에서 겪은 문제들을 기록한다."}],null,["$","meta",null,{"property":"og:site_name","content":"Bran's codeverse"}],null,null,null,[[["$","meta",null,{"property":"og:image","content":"http://localhost:3000/assets/images/posts/thumbnails/rds-dump.png"}]]],null,null,null,null,null,null,[["$","meta",null,{"property":"og:type","content":"article"}],null,null,null,null,null,null]],[["$","meta",null,{"name":"twitter:card","content":"summary_large_image"}],["$","meta",null,{"name":"twitter:site","content":"@codeverse"}],null,null,null,["$","meta",null,{"name":"twitter:title","content":"AWS RDS의 Data base를 dump하기 - Bran's codeverse"}],["$","meta",null,{"name":"twitter:description","content":"VPC 내부에 있는 RDS에서 데이터베이스를 덤프하고, 이를 로컬 MySQL로 복구하는 과정에서 겪은 문제들을 기록한다."}],[[["$","meta",null,{"name":"twitter:image","content":"http://localhost:3000/assets/images/posts/thumbnails/rds-dump.png"}]]],null,null],null,[null,[["$","link",null,{"rel":"icon","href":"/icon.svg?43070ac23468c58b","type":"image/svg+xml","sizes":"32x32"}]],[],null]]
9:I{"id":"4970","chunks":["771:static/chunks/771-4a62562d40204820.js","333:static/chunks/app/posts/[slug]/page-6cd312107a914216.js"],"name":"","async":false}
8:["$","$L9",null,{"post":{"slug":"rds-dump","meta":{"title":"AWS RDS의 Data base를 dump하기","description":"VPC 내부에 있는 RDS에서 데이터베이스를 덤프하고, 이를 로컬 MySQL로 복구하는 과정에서 겪은 문제들을 기록한다.","date":"2021/09/14","tags":["COLUMN_STATISTICS","NO_AUTO_CREATE_USER","column-statistics=0","mysqldump","sed","sql_mode","ssh tunneling"],"thumbnail":"assets/images/posts/thumbnails/rds-dump.png"},"content":"\n## ssh tunneling을 통해 DB dump해오기\n\n- mysqldump 명령어를 사용하여 .sql 파일 형태로 데이터베이스를 덤프할 수 있다.\n- 이 과정에서는 터널링을 수행할 EC2 인스턴스에 MySQL 클라이언트가 설치되어 있어야 한다.\n\n```shell\n$ ssh `tunneling-instanse-username`@`tunneling-instanse-host` -i `key-file-path` mysqldump -u`username` -p`password` -h `remote-db-host` `database-name` > `local/path/to/save.sql`\n```\n\n### COLUMN_STATISTICS\n\n#### 덤프 시도 중 `...: Unknown table 'COLUMN_STATISTICS' in information_schema` 라는 에러가 발생할 경우\n\n- 이 에러는 MySQL 8.0에서 새로 추가된 옵션인 COLUMN_STATISTICS 때문이다. 이 옵션은 테이블의 통계 데이터를 분석하여 덤프 시 포함하는 기능이다. <sup>[레퍼런스](https://jay-ji.tistory.com/62)</sup>\n- 이 옵션을 비활성화하려면 덤프 명령어에 `--column-statistics=0`을 추가한다.\n\n```shell\n$ ssh `tunneling-instanse-username`@`tunneling-instanse-host` -i `key-file-path` mysqldump -u`username` -p`password` -h `remote-db-host` --column-statistics=0 `database-name` > `local/path/to/save.sql`\n```\n\n#### 덤프 시도 중 `...unknown variable 'column-statistics=0'...` 라는 에러가 발생할 경우\n\n- 이 에러는 해당 옵션이 불필요한 경우 발생할 수 있다. 이런 경우에는 덤프 명령어에서 `--column-statistics=0`을 제거하고 다시 시도한다.\n\n## .sql파일을 로컬 mysql에 로드하기\n\n- 덤프한 .sql 파일을 로컬 데이터베이스에 로드할 때는 mysql 명령어를 사용한다.\n- 데이터를 받을 데이터베이스는 미리 생성되어 있고 비어 있어야 한다.\n\n```shell\n$ mysql -u`local-user-name` -p`local-pwd` `database-name` < `path/for/dumped.sql`\n```\n\n### NO_AUTO_CREATE_USER\n\n#### 로드 시도 중 `Variable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'` 라는 에러가 발생할 경우\n\n- 이 에러는 MySQL 8.0 이상 버전에서 발생하는데, 해당 모드는 사용자 생성 관련 모드다. MySQL 8.0 이상에서는 이 모드가 제거되었으며, 대신 `CREATE USER` 또는 `GRANT` 구문을 사용한다.\n- 이 문제를 해결하려면 `dumped.sql` 파일을 수정해야 한다.\n- .sql 파일은 매우 크기 때문에 일반 텍스트 에디터로 수정하는 것은 비효율적이다. 대신 `sed` 명령어를 사용해 빠르게 수정할 수 있다.\n- `macOS`와 같은 `Unix` 계열 시스템에서는 다음과 같이 `sed` 명령어를 사용한다.\n\n```shell\nsed -i '' 's/NO_AUTO_CREATE_USER//' `path/for/dumped.sql`\n```\n\n- 수정한 후 다시 데이터를 로드하면 된다.\n"},"meta":{"title":"AWS RDS의 Data base를 dump하기","description":"VPC 내부에 있는 RDS에서 데이터베이스를 덤프하고, 이를 로컬 MySQL로 복구하는 과정에서 겪은 문제들을 기록한다.","date":"2021/09/14","tags":["COLUMN_STATISTICS","NO_AUTO_CREATE_USER","column-statistics=0","mysqldump","sed","sql_mode","ssh tunneling"],"thumbnail":"assets/images/posts/thumbnails/rds-dump.png"},"content":"<h2 id=\"ssh-tunneling을-통해-db-dump해오기\" class=\"heading\">ssh tunneling을 통해 DB dump해오기</h2>\n<ul>\n<li>mysqldump 명령어를 사용하여 .sql 파일 형태로 데이터베이스를 덤프할 수 있다.</li>\n<li>이 과정에서는 터널링을 수행할 EC2 인스턴스에 MySQL 클라이언트가 설치되어 있어야 한다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">ssh</span> <span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-username<span class=\"token variable\">`</span></span>@<span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-host<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-i</span> <span class=\"token variable\"><span class=\"token variable\">`</span>key-file-path<span class=\"token variable\">`</span></span> mysqldump -u<span class=\"token variable\"><span class=\"token variable\">`</span>username<span class=\"token variable\">`</span></span> -p<span class=\"token variable\"><span class=\"token variable\">`</span>password<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-h</span> <span class=\"token variable\"><span class=\"token variable\">`</span>remote-db-host<span class=\"token variable\">`</span></span> <span class=\"token variable\"><span class=\"token variable\">`</span>database-name<span class=\"token variable\">`</span></span> <span class=\"token operator\">></span> <span class=\"token variable\"><span class=\"token variable\">`</span>local/path/to/save.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<h3 id=\"column_statistics\">COLUMN_STATISTICS</h3>\n<h4 id=\"덤프-시도-중--unknown-table-column_statistics-in-information_schema-라는-에러가-발생할-경우\">덤프 시도 중 <code>...: Unknown table 'COLUMN_STATISTICS' in information_schema</code> 라는 에러가 발생할 경우</h4>\n<ul>\n<li>이 에러는 MySQL 8.0에서 새로 추가된 옵션인 COLUMN_STATISTICS 때문이다. 이 옵션은 테이블의 통계 데이터를 분석하여 덤프 시 포함하는 기능이다. <sup><a href=\"https://jay-ji.tistory.com/62\" target=\"_blank\" rel=\"noopener noreferer\">레퍼런스</a></sup></li>\n<li>이 옵션을 비활성화하려면 덤프 명령어에 <code>--column-statistics=0</code>을 추가한다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ <span class=\"token function\">ssh</span> <span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-username<span class=\"token variable\">`</span></span>@<span class=\"token variable\"><span class=\"token variable\">`</span>tunneling-instanse-host<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-i</span> <span class=\"token variable\"><span class=\"token variable\">`</span>key-file-path<span class=\"token variable\">`</span></span> mysqldump -u<span class=\"token variable\"><span class=\"token variable\">`</span>username<span class=\"token variable\">`</span></span> -p<span class=\"token variable\"><span class=\"token variable\">`</span>password<span class=\"token variable\">`</span></span> <span class=\"token parameter variable\">-h</span> <span class=\"token variable\"><span class=\"token variable\">`</span>remote-db-host<span class=\"token variable\">`</span></span> --column-statistics<span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token variable\"><span class=\"token variable\">`</span>database-name<span class=\"token variable\">`</span></span> <span class=\"token operator\">></span> <span class=\"token variable\"><span class=\"token variable\">`</span>local/path/to/save.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<h4 id=\"덤프-시도-중-unknown-variable-column-statistics0-라는-에러가-발생할-경우\">덤프 시도 중 <code>...unknown variable 'column-statistics=0'...</code> 라는 에러가 발생할 경우</h4>\n<ul>\n<li>이 에러는 해당 옵션이 불필요한 경우 발생할 수 있다. 이런 경우에는 덤프 명령어에서 <code>--column-statistics=0</code>을 제거하고 다시 시도한다.</li>\n</ul>\n<h2 id=\"sql파일을-로컬-mysql에-로드하기\" class=\"heading\">.sql파일을 로컬 mysql에 로드하기</h2>\n<ul>\n<li>덤프한 .sql 파일을 로컬 데이터베이스에 로드할 때는 mysql 명령어를 사용한다.</li>\n<li>데이터를 받을 데이터베이스는 미리 생성되어 있고 비어 있어야 한다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\">$ mysql -u<span class=\"token variable\"><span class=\"token variable\">`</span>local-user-name<span class=\"token variable\">`</span></span> -p<span class=\"token variable\"><span class=\"token variable\">`</span>local-pwd<span class=\"token variable\">`</span></span> <span class=\"token variable\"><span class=\"token variable\">`</span>database-name<span class=\"token variable\">`</span></span> <span class=\"token operator\">&#x3C;</span> <span class=\"token variable\"><span class=\"token variable\">`</span>path/for/dumped.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<h3 id=\"no_auto_create_user\">NO_AUTO_CREATE_USER</h3>\n<h4 id=\"로드-시도-중-variable-sql_mode-cant-be-set-to-the-value-of-no_auto_create_user-라는-에러가-발생할-경우\">로드 시도 중 <code>Variable 'sql_mode' can't be set to the value of 'NO_AUTO_CREATE_USER'</code> 라는 에러가 발생할 경우</h4>\n<ul>\n<li>이 에러는 MySQL 8.0 이상 버전에서 발생하는데, 해당 모드는 사용자 생성 관련 모드다. MySQL 8.0 이상에서는 이 모드가 제거되었으며, 대신 <code>CREATE USER</code> 또는 <code>GRANT</code> 구문을 사용한다.</li>\n<li>이 문제를 해결하려면 <code>dumped.sql</code> 파일을 수정해야 한다.</li>\n<li>.sql 파일은 매우 크기 때문에 일반 텍스트 에디터로 수정하는 것은 비효율적이다. 대신 <code>sed</code> 명령어를 사용해 빠르게 수정할 수 있다.</li>\n<li><code>macOS</code>와 같은 <code>Unix</code> 계열 시스템에서는 다음과 같이 <code>sed</code> 명령어를 사용한다.</li>\n</ul>\n<pre class=\"language-shell\"><code class=\"language-shell code-highlight\"><span class=\"code-line\"><span class=\"token function\">sed</span> <span class=\"token parameter variable\">-i</span> <span class=\"token string\">''</span> <span class=\"token string\">'s/NO_AUTO_CREATE_USER//'</span> <span class=\"token variable\"><span class=\"token variable\">`</span>path/for/dumped.sql<span class=\"token variable\">`</span></span>\n</span></code></pre>\n<ul>\n<li>수정한 후 다시 데이터를 로드하면 된다.</li>\n</ul>"}]
